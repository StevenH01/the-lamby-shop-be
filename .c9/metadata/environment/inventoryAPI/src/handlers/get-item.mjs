{"filter":false,"title":"get-item.mjs","tooltip":"/inventoryAPI/src/handlers/get-item.mjs","undoManager":{"mark":39,"position":39,"stack":[[{"start":{"row":0,"column":0},"end":{"row":300,"column":1},"action":"insert","lines":["// Create clients and set shared const values outside of the handler.","","// Create a DocumentClient that represents the query to add an item","import { DynamoDBClient } from '@aws-sdk/client-dynamodb';","import { DynamoDBDocumentClient, GetCommand } from '@aws-sdk/lib-dynamodb';","import {format} from './itemFormat.mjs'","","const client = new DynamoDBClient({});","const ddbDocClient = DynamoDBDocumentClient.from(client);","","// Get the DynamoDB table name from environment variables","const tableName = 'citizenTable';","","/**"," * A simple example includes a HTTP get method to get one item by id from a DynamoDB table."," */","export const getByIdHandler = async (event) => {","  // if (event.httpMethod !== 'GET') {","  //   throw new Error(`getMethod only accept GET method, you tried: ${event.httpMethod}`);","  // }","  // All log statements are written to CloudWatch","  console.info('received:', event);","  ","  // Retrieve documentNumber from path parameters","  const isRunningLocally = process.env.AWS_SAM_LOCAL;","  var documentNumber;","  if (isRunningLocally == 'false') {","    console.log(\"Called via API\");","    documentNumber = JSON.parse(event.pathParameters.documentNumber);","  }","  else {","    console.log(\"Called via locally\");","    documentNumber = event.pathParameters.documentNumber;","  }","  // Echo the the value of \"requestId\" from the request header into \"responseId\"","  // var responseId = event.headerParameters.requestId;","","","  // Get the item from the table","  // https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/DynamoDB/DocumentClient.html#get-property","  var params = {","    TableName : tableName,","    Key: { documentNumber: documentNumber },","  };","","  try {","    const data = await ddbDocClient.send(new GetCommand(params));","    var item = await format(data.Item);","    /*","    item.birthDate = await formatDateLong(item.birthDate);","    item.issue = await formatDateShort(item.issue);","    item.residentPostalCode = item.residentPostalCode.substring(0,5);","    if(item.domesticDrivingPrivileges != undefined) {","      for(let i=0;i<item.domesticDrivingPrivileges.length;i++) {","        if(item.domesticDrivingPrivileges[i].domesticVehicleClass != undefined) {","          if(item.domesticDrivingPrivileges[i].domesticVehicleClass.issueDate != undefined) {","            item.domesticDrivingPrivileges[i].domesticVehicleClass.issueDate = await formatDateShort(item.domesticDrivingPrivileges[i].domesticVehicleClass.issueDate);","          }","          if(item.domesticDrivingPrivileges[i].domesticVehicleClass.expiryDate != undefined) {","            item.domesticDrivingPrivileges[i].domesticVehicleClass.expiryDate = await formatDateShort(item.domesticDrivingPrivileges[i].domesticVehicleClass.expiryDate);","          }","        }","        ","      }","    }","  ","    if(item.drivingPrivileges != undefined) {","      for(let i=0;i<item.drivingPrivileges.length;i++) {","        if(item.drivingPrivileges[i].issueDate != undefined) {","          item.drivingPrivileges[i].issueDate = await formatDateShort(item.drivingPrivileges[i].issueDate);","        }","        if(item.drivingPrivileges[i].expiryDate != undefined) {","          item.drivingPrivileges[i].expiryDate = await formatDateShort(item.drivingPrivileges[i].expiryDate);","        }","      }","    }","    item.expiry = await formatDateShort(item.expiry);","    item.portraitCaptureDate = await formatDateShort(item.portraitCaptureDate);","    item.height = await formatHeight(item.height);","    item.weight = await formatWeight(item.weight);","    item.sex = await formatSex(item.sex);","    item.hairColor = await formatHairColor(item.hairColor);","    item.eyeColor = await formatEyeColor(item.eyeColor);","    item.aamvaData = await getAamVaData(item);","    */","  } catch (err) {","    console.log(\"Error\", err);","  }"," ","  const response = {","    statusCode: 200,","    body: JSON.stringify(item)","  };"," ","  // All log statements are written to CloudWatch","  console.info(`statusCode: ${response.statusCode}`);","  // console.log(`responseId: ` + responseId);","  console.log(`documentNumber: ` + documentNumber);","  return response;","}","const formatDateShort = async (dateString) => {","  console.log(\"dateString %s\", dateString);","  if(dateString == undefined || dateString == null) {","    return dateString;","  } ","  var date = new Date(dateString);","  const year = date.getFullYear().toString().substring(2,4);","  const month = String(date.getMonth() + 1).padStart(2, '0');","  const day = String(date.getDate()).padStart(2, '0');","","  return `${month}-${day}-${year}`;","}","const formatDateLong = async (dateString) => {","  console.log(\"dateString %s\", dateString);","  if(dateString == undefined || dateString == null) {","    return dateString;","  } ","  var date = new Date(dateString);","  const year = date.getFullYear();","  const month = String(date.getMonth() + 1).padStart(2, '0');","  const day = String(date.getDate()).padStart(2, '0');","","  return `${month}-${day}-${year}`;","}","","const formatHeight = async (height) => {","  //format: 5-07 (feet-inches)","  console.log(\"height %s\", height);","  if(height == undefined || height == null) {","    return height;","  } ","","  var splitHeight = height.split(' ');","  var heightInInches = Number(splitHeight[0]);","  if(splitHeight[1] == \"cm\") {","    var heightInInches = heightInInches/2.54;","  }  ","  var feet = Math.floor(heightInInches/12);","  var inches = Math.floor(heightInInches % 12);","  return feet + \"-\" + inches.toString().padStart(2, '0');","}","const formatWeight = async (weight) => {","  //format: 117 -- for 117 lb","  console.log(\"weight %s\", weight);","  if(weight == undefined || weight == null) {","    return weight;","  } ","  var splitWeight = weight.split(' ');","  var weightInLB = Number(splitWeight[0]);","  if(splitWeight[1] == \"kg\") {","    var weightInLB = weightInLB*2.205;","  }  ","  return Math.floor(weightInLB).toString();","","}","const formatSex = async (sex) => {","  //format: 117 -- for 117 lb","  console.log(\"sex %s\", sex);","  if(sex == undefined || sex == null) {","    return sex;","  } ","  var rtnSex = \"MALE\";","  if(sex == \"2\") {","    var rtnSex = \"FEMALE\";","  }  ","  return rtnSex;","","}","const formatEyeColor = async (eyeColor) => {","  console.log(\"eyeColor %s\", eyeColor);","  //var rtnEyeColor = \"UNK\";","  //\"black\" \"blue\" \"brown\" \"dichromatic\" \"green\" \"grey\" \"hazel\" \"maroon\" \"pink\" \"unknown\"","  switch(eyeColor) {","    case \"black\":","      return \"BLK\";","    case \"blue\":","      return \"BLU\";","    case \"brown\":","      return \"BRO\";","    case \"dichromatic\":","      return \"UNK\";","    case \"green\":","      return \"GRN\";","    case \"grey\":","      return \"GRY\";","    case \"hazel\":","      return \"HAZ\";","    case \"maroon\":","      return \"MAR\";","    case \"pink\":","      return \"PNK\";","    default:","      return \"UNK\"","  }","}","const formatHairColor = async (hairColor) => {","  console.log(\"hairColor %s\", hairColor);","  //\"bald\" \"black\" \"blond\" \"brown\" \"grey\" \"red\" \"auburn\" \"sandy\" \"white\" \"unknown\"","  switch(hairColor) {","    case \"unknown\":","      return \"OTHER\";","    default:","      return hairColor.toUpperCase();","  }","}","","","const getAamVaDataUnicode = async (item) => {","  let pdf417 = \"@\\u0010\\\\u0030\\u0013ANSI 636055090102DL00410252ZG02930127DL\";","  let uNewLine =\"\\u0010\";","","  let aGivenName = item.givenName.split(\" \");","  let firstName = aGivenName[0];","  let middleName = aGivenName[1];","","  ","  ","  pdf417 += \"DAQ\" + item.documentNumber;","  pdf417 += uNewLine + \"DCS\" + item.familyName.toUpperCase(); //lastName","  pdf417 += uNewLine + \"DDE\" + \"N\"; //isLastNameTruncated","  pdf417 += uNewLine + \"DAC\" + firstName.toUpperCase(); //firstName","  pdf417 += uNewLine + \"DDF\" + \"N\"; //isFirstNameTruncated","  pdf417 += uNewLine + \"DAD\" + (middleName == undefined) ? '' : middleName.toUpperCase();","  pdf417 += uNewLine + \"DDG\" + \"N\"; //isMiddleNameTruncated","  pdf417 += uNewLine + \"DCA\" + item.vehicleClass.toUpperCase(); //jurisdictionSpecificVehicleClass","  pdf417 += uNewLine + \"DCB\" + ((item.domesticDrivingPrivileges[0].domesticVehicleRestrictions[0].domesticVehicleRestrictionCode == undefined) ? \"NONE\" : item.domesticDrivingPrivileges[0].domesticVehicleRestrictions[0].domesticVehicleRestrictionCode); //jurisdictionSpecificRestrictionCodes","  pdf417 += uNewLine + \"DCD\" + ((item.domesticDrivingPrivileges[0].domesticVehicleEndorsements[0].domesticVehicleEndorsementCode == undefined) ? \"NONE\" : item.domesticDrivingPrivileges[0].domesticVehicleEndorsements[0].domesticVehicleEndorsementCode); //jurisdictionSpecificEndorsementCodes","  pdf417 += uNewLine + \"DBD\" + await getpdf417DateFormat(item.issue); //documentIssueDate","  pdf417 += uNewLine + \"DBB\" + await getpdf417DateFormat(item.birthDate); //dateOfBirth","  pdf417 += uNewLine + \"DBA\" + await getpdf417DateFormat(item.expiry); //documentExpirationDate","  pdf417 += uNewLine + \"DBC\" + item.sex.toUpperCase(); //physicalDescriptionSex","  pdf417 += uNewLine + \"DAU\" + item.height.toUpperCase(); //physicalDescriptionHeight","  pdf417 += uNewLine + \"DAY\" + item.eyeColor.toUpperCase(); //physicalDescriptionEyeColor","  pdf417 += uNewLine + \"DAG\" + item.residentAddress.toUpperCase(); //addressStreet1","  pdf417 += uNewLine + \"DAI\" + item.residentCity.toUpperCase(); //addressCity","  pdf417 += uNewLine + \"DAJ\" + item.residentState.toUpperCase(); //addressJurisdictionCode","  pdf417 += uNewLine + \"DAK\" + item.residentPostalCode.toUpperCase(); //addressPostalCode","  pdf417 += uNewLine + \"DCF\" + item.documentDiscriminator; //documentDiscriminator","  pdf417 += uNewLine + \"DCG\" + item.residentCountry.toUpperCase(); //countryIdentification","  pdf417 += uNewLine + \"DAW\" + item.weight.toUpperCase(); //weightPounds","  pdf417 += uNewLine + \"DAZ\" + item.hairColor.toUpperCase(); //hairColor","  pdf417 += uNewLine + \"DCK\" + item.administrativeNumber.toUpperCase(); //inventoryControlNumber","  pdf417 += uNewLine + \"DDA\" + item.complianceType.toUpperCase(); //complianceType","  pdf417 += uNewLine + \"DDB\" + \"08292017\"; //cardRevisionDate ","  pdf417 += \"\\u0013\";","  return pdf417;","","}","const getAamVaData = async (item) => {","  let pdf417 = \"@\\n\\u001e\\rANSI 636055090102DL00410252ZG02930127DL\";","  let uNewLine =\"\\n\";","","  let aGivenName = item.givenName.split(\" \");","  let firstName = aGivenName[0];","  let middleName = aGivenName[1];","","  ","  ","  pdf417 += \"DAQ\" + item.documentNumber;","  pdf417 += uNewLine + \"DCS\" + item.familyName.toUpperCase(); //lastName","  pdf417 += uNewLine + \"DDE\" + \"N\"; //isLastNameTruncated","  pdf417 += uNewLine + \"DAC\" + firstName.toUpperCase(); //firstName","  pdf417 += uNewLine + \"DDF\" + \"N\"; //isFirstNameTruncated","  pdf417 += uNewLine + \"DAD\" + (middleName == undefined) ? '' : middleName.toUpperCase();","  pdf417 += uNewLine + \"DDG\" + \"N\"; //isMiddleNameTruncated","  pdf417 += uNewLine + \"DCA\" + item.vehicleClass.toUpperCase(); //jurisdictionSpecificVehicleClass","  pdf417 += uNewLine + \"DCB\" + ((item.domesticDrivingPrivileges[0].domesticVehicleRestrictions[0].domesticVehicleRestrictionCode == undefined) ? \"NONE\" : item.domesticDrivingPrivileges[0].domesticVehicleRestrictions[0].domesticVehicleRestrictionCode); //jurisdictionSpecificRestrictionCodes","  pdf417 += uNewLine + \"DCD\" + ((item.domesticDrivingPrivileges[0].domesticVehicleEndorsements[0].domesticVehicleEndorsementCode == undefined) ? \"NONE\" : item.domesticDrivingPrivileges[0].domesticVehicleEndorsements[0].domesticVehicleEndorsementCode); //jurisdictionSpecificEndorsementCodes","  pdf417 += uNewLine + \"DBD\" + await getpdf417DateFormat(item.issue); //documentIssueDate","  pdf417 += uNewLine + \"DBB\" + await getpdf417DateFormat(item.birthDate); //dateOfBirth","  pdf417 += uNewLine + \"DBA\" + await getpdf417DateFormat(item.expiry); //documentExpirationDate","  pdf417 += uNewLine + \"DBC\" + item.sex.toUpperCase(); //physicalDescriptionSex","  pdf417 += uNewLine + \"DAU\" + item.height.toUpperCase(); //physicalDescriptionHeight","  pdf417 += uNewLine + \"DAY\" + item.eyeColor.toUpperCase(); //physicalDescriptionEyeColor","  pdf417 += uNewLine + \"DAG\" + item.residentAddress.toUpperCase(); //addressStreet1","  pdf417 += uNewLine + \"DAI\" + item.residentCity.toUpperCase(); //addressCity","  pdf417 += uNewLine + \"DAJ\" + item.residentState.toUpperCase(); //addressJurisdictionCode","  pdf417 += uNewLine + \"DAK\" + item.residentPostalCode.toUpperCase(); //addressPostalCode","  pdf417 += uNewLine + \"DCF\" + item.documentDiscriminator; //documentDiscriminator","  pdf417 += uNewLine + \"DCG\" + item.residentCountry.toUpperCase(); //countryIdentification","  pdf417 += uNewLine + \"DAW\" + item.weight.toUpperCase(); //weightPounds","  pdf417 += uNewLine + \"DAZ\" + item.hairColor.toUpperCase(); //hairColor","  pdf417 += uNewLine + \"DCK\" + item.administrativeNumber.toUpperCase(); //inventoryControlNumber","  pdf417 += uNewLine + \"DDA\" + item.complianceType.toUpperCase(); //complianceType","  pdf417 += uNewLine + \"DDB\" + \"08292017\"; //cardRevisionDate ","  pdf417 += \"\\rZCZCAHZL\\nZCBBRN\\nZCC\\nZCD\\r\";","  return pdf417;","","}","const getpdf417DateFormat = async (inDateString) => {","  let inDate = new Date(inDateString);","  let mm = inDate.getMonth() + 1; // getMonth() is zero-based","  let dd = inDate.getDate();","","  return [","          (mm>9 ? '' : '0') + mm,","          (dd>9 ? '' : '0') + dd,","          inDate.getFullYear(), ","        ].join('');","  ","}"],"id":42}],[{"start":{"row":11,"column":0},"end":{"row":11,"column":33},"action":"remove","lines":["const tableName = 'citizenTable';"],"id":43},{"start":{"row":11,"column":0},"end":{"row":11,"column":44},"action":"insert","lines":["const tableName = process.env.CITIZEN_TABLE;"]}],[{"start":{"row":25,"column":6},"end":{"row":25,"column":20},"action":"remove","lines":["documentNumber"],"id":44},{"start":{"row":25,"column":6},"end":{"row":25,"column":7},"action":"insert","lines":["i"]},{"start":{"row":25,"column":7},"end":{"row":25,"column":8},"action":"insert","lines":["t"]},{"start":{"row":25,"column":8},"end":{"row":25,"column":9},"action":"insert","lines":["e"]},{"start":{"row":25,"column":9},"end":{"row":25,"column":10},"action":"insert","lines":["m"]},{"start":{"row":25,"column":10},"end":{"row":25,"column":11},"action":"insert","lines":["N"]},{"start":{"row":25,"column":11},"end":{"row":25,"column":12},"action":"insert","lines":["a"]},{"start":{"row":25,"column":12},"end":{"row":25,"column":13},"action":"insert","lines":["m"]},{"start":{"row":25,"column":13},"end":{"row":25,"column":14},"action":"insert","lines":["e"]}],[{"start":{"row":28,"column":4},"end":{"row":28,"column":18},"action":"remove","lines":["documentNumber"],"id":45},{"start":{"row":28,"column":4},"end":{"row":28,"column":5},"action":"insert","lines":["i"]},{"start":{"row":28,"column":5},"end":{"row":28,"column":6},"action":"insert","lines":["t"]},{"start":{"row":28,"column":6},"end":{"row":28,"column":7},"action":"insert","lines":["e"]},{"start":{"row":28,"column":7},"end":{"row":28,"column":8},"action":"insert","lines":["m"]},{"start":{"row":28,"column":8},"end":{"row":28,"column":9},"action":"insert","lines":["N"]},{"start":{"row":28,"column":9},"end":{"row":28,"column":10},"action":"insert","lines":["a"]},{"start":{"row":28,"column":10},"end":{"row":28,"column":11},"action":"insert","lines":["m"]},{"start":{"row":28,"column":11},"end":{"row":28,"column":12},"action":"insert","lines":["e"]}],[{"start":{"row":28,"column":47},"end":{"row":28,"column":61},"action":"remove","lines":["documentNumber"],"id":46},{"start":{"row":28,"column":47},"end":{"row":28,"column":48},"action":"insert","lines":["i"]},{"start":{"row":28,"column":48},"end":{"row":28,"column":49},"action":"insert","lines":["t"]},{"start":{"row":28,"column":49},"end":{"row":28,"column":50},"action":"insert","lines":["e"]},{"start":{"row":28,"column":50},"end":{"row":28,"column":51},"action":"insert","lines":["m"]},{"start":{"row":28,"column":51},"end":{"row":28,"column":52},"action":"insert","lines":["N"]},{"start":{"row":28,"column":52},"end":{"row":28,"column":53},"action":"insert","lines":["a"]},{"start":{"row":28,"column":53},"end":{"row":28,"column":54},"action":"insert","lines":["m"]},{"start":{"row":28,"column":54},"end":{"row":28,"column":55},"action":"insert","lines":["e"]}],[{"start":{"row":32,"column":4},"end":{"row":32,"column":18},"action":"remove","lines":["documentNumber"],"id":47},{"start":{"row":32,"column":4},"end":{"row":32,"column":5},"action":"insert","lines":["i"]},{"start":{"row":32,"column":5},"end":{"row":32,"column":6},"action":"insert","lines":["t"]},{"start":{"row":32,"column":6},"end":{"row":32,"column":7},"action":"insert","lines":["e"]},{"start":{"row":32,"column":7},"end":{"row":32,"column":8},"action":"insert","lines":["m"]},{"start":{"row":32,"column":8},"end":{"row":32,"column":9},"action":"insert","lines":["N"]},{"start":{"row":32,"column":9},"end":{"row":32,"column":10},"action":"insert","lines":["a"]},{"start":{"row":32,"column":10},"end":{"row":32,"column":11},"action":"insert","lines":["m"]},{"start":{"row":32,"column":11},"end":{"row":32,"column":12},"action":"insert","lines":["e"]}],[{"start":{"row":32,"column":36},"end":{"row":32,"column":50},"action":"remove","lines":["documentNumber"],"id":48},{"start":{"row":32,"column":36},"end":{"row":32,"column":37},"action":"insert","lines":["i"]},{"start":{"row":32,"column":37},"end":{"row":32,"column":38},"action":"insert","lines":["t"]},{"start":{"row":32,"column":38},"end":{"row":32,"column":39},"action":"insert","lines":["e"]},{"start":{"row":32,"column":39},"end":{"row":32,"column":40},"action":"insert","lines":["m"]},{"start":{"row":32,"column":40},"end":{"row":32,"column":41},"action":"insert","lines":["N"]},{"start":{"row":32,"column":41},"end":{"row":32,"column":42},"action":"insert","lines":["a"]},{"start":{"row":32,"column":42},"end":{"row":32,"column":43},"action":"insert","lines":["m"]},{"start":{"row":32,"column":43},"end":{"row":32,"column":44},"action":"insert","lines":["e"]}],[{"start":{"row":42,"column":11},"end":{"row":42,"column":25},"action":"remove","lines":["documentNumber"],"id":49},{"start":{"row":42,"column":11},"end":{"row":42,"column":12},"action":"insert","lines":["i"]},{"start":{"row":42,"column":12},"end":{"row":42,"column":13},"action":"insert","lines":["t"]},{"start":{"row":42,"column":13},"end":{"row":42,"column":14},"action":"insert","lines":["e"]},{"start":{"row":42,"column":14},"end":{"row":42,"column":15},"action":"insert","lines":["m"]},{"start":{"row":42,"column":15},"end":{"row":42,"column":16},"action":"insert","lines":["N"]},{"start":{"row":42,"column":16},"end":{"row":42,"column":17},"action":"insert","lines":["a"]},{"start":{"row":42,"column":17},"end":{"row":42,"column":18},"action":"insert","lines":["m"]},{"start":{"row":42,"column":18},"end":{"row":42,"column":19},"action":"insert","lines":["e"]}],[{"start":{"row":42,"column":21},"end":{"row":42,"column":35},"action":"remove","lines":["documentNumber"],"id":50},{"start":{"row":42,"column":21},"end":{"row":42,"column":22},"action":"insert","lines":["I"]}],[{"start":{"row":42,"column":21},"end":{"row":42,"column":22},"action":"remove","lines":["I"],"id":51}],[{"start":{"row":42,"column":21},"end":{"row":42,"column":22},"action":"insert","lines":["i"],"id":52},{"start":{"row":42,"column":22},"end":{"row":42,"column":23},"action":"insert","lines":["t"]},{"start":{"row":42,"column":23},"end":{"row":42,"column":24},"action":"insert","lines":["e"]},{"start":{"row":42,"column":24},"end":{"row":42,"column":25},"action":"insert","lines":["m"]},{"start":{"row":42,"column":25},"end":{"row":42,"column":26},"action":"insert","lines":["N"]},{"start":{"row":42,"column":26},"end":{"row":42,"column":27},"action":"insert","lines":["a"]},{"start":{"row":42,"column":27},"end":{"row":42,"column":28},"action":"insert","lines":["m"]},{"start":{"row":42,"column":28},"end":{"row":42,"column":29},"action":"insert","lines":["e"]}],[{"start":{"row":48,"column":0},"end":{"row":84,"column":6},"action":"remove","lines":["    /*","    item.birthDate = await formatDateLong(item.birthDate);","    item.issue = await formatDateShort(item.issue);","    item.residentPostalCode = item.residentPostalCode.substring(0,5);","    if(item.domesticDrivingPrivileges != undefined) {","      for(let i=0;i<item.domesticDrivingPrivileges.length;i++) {","        if(item.domesticDrivingPrivileges[i].domesticVehicleClass != undefined) {","          if(item.domesticDrivingPrivileges[i].domesticVehicleClass.issueDate != undefined) {","            item.domesticDrivingPrivileges[i].domesticVehicleClass.issueDate = await formatDateShort(item.domesticDrivingPrivileges[i].domesticVehicleClass.issueDate);","          }","          if(item.domesticDrivingPrivileges[i].domesticVehicleClass.expiryDate != undefined) {","            item.domesticDrivingPrivileges[i].domesticVehicleClass.expiryDate = await formatDateShort(item.domesticDrivingPrivileges[i].domesticVehicleClass.expiryDate);","          }","        }","        ","      }","    }","  ","    if(item.drivingPrivileges != undefined) {","      for(let i=0;i<item.drivingPrivileges.length;i++) {","        if(item.drivingPrivileges[i].issueDate != undefined) {","          item.drivingPrivileges[i].issueDate = await formatDateShort(item.drivingPrivileges[i].issueDate);","        }","        if(item.drivingPrivileges[i].expiryDate != undefined) {","          item.drivingPrivileges[i].expiryDate = await formatDateShort(item.drivingPrivileges[i].expiryDate);","        }","      }","    }","    item.expiry = await formatDateShort(item.expiry);","    item.portraitCaptureDate = await formatDateShort(item.portraitCaptureDate);","    item.height = await formatHeight(item.height);","    item.weight = await formatWeight(item.weight);","    item.sex = await formatSex(item.sex);","    item.hairColor = await formatHairColor(item.hairColor);","    item.eyeColor = await formatEyeColor(item.eyeColor);","    item.aamvaData = await getAamVaData(item);","    */"],"id":53}],[{"start":{"row":64,"column":0},"end":{"row":264,"column":1},"action":"remove","lines":["const formatDateShort = async (dateString) => {","  console.log(\"dateString %s\", dateString);","  if(dateString == undefined || dateString == null) {","    return dateString;","  } ","  var date = new Date(dateString);","  const year = date.getFullYear().toString().substring(2,4);","  const month = String(date.getMonth() + 1).padStart(2, '0');","  const day = String(date.getDate()).padStart(2, '0');","","  return `${month}-${day}-${year}`;","}","const formatDateLong = async (dateString) => {","  console.log(\"dateString %s\", dateString);","  if(dateString == undefined || dateString == null) {","    return dateString;","  } ","  var date = new Date(dateString);","  const year = date.getFullYear();","  const month = String(date.getMonth() + 1).padStart(2, '0');","  const day = String(date.getDate()).padStart(2, '0');","","  return `${month}-${day}-${year}`;","}","","const formatHeight = async (height) => {","  //format: 5-07 (feet-inches)","  console.log(\"height %s\", height);","  if(height == undefined || height == null) {","    return height;","  } ","","  var splitHeight = height.split(' ');","  var heightInInches = Number(splitHeight[0]);","  if(splitHeight[1] == \"cm\") {","    var heightInInches = heightInInches/2.54;","  }  ","  var feet = Math.floor(heightInInches/12);","  var inches = Math.floor(heightInInches % 12);","  return feet + \"-\" + inches.toString().padStart(2, '0');","}","const formatWeight = async (weight) => {","  //format: 117 -- for 117 lb","  console.log(\"weight %s\", weight);","  if(weight == undefined || weight == null) {","    return weight;","  } ","  var splitWeight = weight.split(' ');","  var weightInLB = Number(splitWeight[0]);","  if(splitWeight[1] == \"kg\") {","    var weightInLB = weightInLB*2.205;","  }  ","  return Math.floor(weightInLB).toString();","","}","const formatSex = async (sex) => {","  //format: 117 -- for 117 lb","  console.log(\"sex %s\", sex);","  if(sex == undefined || sex == null) {","    return sex;","  } ","  var rtnSex = \"MALE\";","  if(sex == \"2\") {","    var rtnSex = \"FEMALE\";","  }  ","  return rtnSex;","","}","const formatEyeColor = async (eyeColor) => {","  console.log(\"eyeColor %s\", eyeColor);","  //var rtnEyeColor = \"UNK\";","  //\"black\" \"blue\" \"brown\" \"dichromatic\" \"green\" \"grey\" \"hazel\" \"maroon\" \"pink\" \"unknown\"","  switch(eyeColor) {","    case \"black\":","      return \"BLK\";","    case \"blue\":","      return \"BLU\";","    case \"brown\":","      return \"BRO\";","    case \"dichromatic\":","      return \"UNK\";","    case \"green\":","      return \"GRN\";","    case \"grey\":","      return \"GRY\";","    case \"hazel\":","      return \"HAZ\";","    case \"maroon\":","      return \"MAR\";","    case \"pink\":","      return \"PNK\";","    default:","      return \"UNK\"","  }","}","const formatHairColor = async (hairColor) => {","  console.log(\"hairColor %s\", hairColor);","  //\"bald\" \"black\" \"blond\" \"brown\" \"grey\" \"red\" \"auburn\" \"sandy\" \"white\" \"unknown\"","  switch(hairColor) {","    case \"unknown\":","      return \"OTHER\";","    default:","      return hairColor.toUpperCase();","  }","}","","","const getAamVaDataUnicode = async (item) => {","  let pdf417 = \"@\\u0010\\\\u0030\\u0013ANSI 636055090102DL00410252ZG02930127DL\";","  let uNewLine =\"\\u0010\";","","  let aGivenName = item.givenName.split(\" \");","  let firstName = aGivenName[0];","  let middleName = aGivenName[1];","","  ","  ","  pdf417 += \"DAQ\" + item.documentNumber;","  pdf417 += uNewLine + \"DCS\" + item.familyName.toUpperCase(); //lastName","  pdf417 += uNewLine + \"DDE\" + \"N\"; //isLastNameTruncated","  pdf417 += uNewLine + \"DAC\" + firstName.toUpperCase(); //firstName","  pdf417 += uNewLine + \"DDF\" + \"N\"; //isFirstNameTruncated","  pdf417 += uNewLine + \"DAD\" + (middleName == undefined) ? '' : middleName.toUpperCase();","  pdf417 += uNewLine + \"DDG\" + \"N\"; //isMiddleNameTruncated","  pdf417 += uNewLine + \"DCA\" + item.vehicleClass.toUpperCase(); //jurisdictionSpecificVehicleClass","  pdf417 += uNewLine + \"DCB\" + ((item.domesticDrivingPrivileges[0].domesticVehicleRestrictions[0].domesticVehicleRestrictionCode == undefined) ? \"NONE\" : item.domesticDrivingPrivileges[0].domesticVehicleRestrictions[0].domesticVehicleRestrictionCode); //jurisdictionSpecificRestrictionCodes","  pdf417 += uNewLine + \"DCD\" + ((item.domesticDrivingPrivileges[0].domesticVehicleEndorsements[0].domesticVehicleEndorsementCode == undefined) ? \"NONE\" : item.domesticDrivingPrivileges[0].domesticVehicleEndorsements[0].domesticVehicleEndorsementCode); //jurisdictionSpecificEndorsementCodes","  pdf417 += uNewLine + \"DBD\" + await getpdf417DateFormat(item.issue); //documentIssueDate","  pdf417 += uNewLine + \"DBB\" + await getpdf417DateFormat(item.birthDate); //dateOfBirth","  pdf417 += uNewLine + \"DBA\" + await getpdf417DateFormat(item.expiry); //documentExpirationDate","  pdf417 += uNewLine + \"DBC\" + item.sex.toUpperCase(); //physicalDescriptionSex","  pdf417 += uNewLine + \"DAU\" + item.height.toUpperCase(); //physicalDescriptionHeight","  pdf417 += uNewLine + \"DAY\" + item.eyeColor.toUpperCase(); //physicalDescriptionEyeColor","  pdf417 += uNewLine + \"DAG\" + item.residentAddress.toUpperCase(); //addressStreet1","  pdf417 += uNewLine + \"DAI\" + item.residentCity.toUpperCase(); //addressCity","  pdf417 += uNewLine + \"DAJ\" + item.residentState.toUpperCase(); //addressJurisdictionCode","  pdf417 += uNewLine + \"DAK\" + item.residentPostalCode.toUpperCase(); //addressPostalCode","  pdf417 += uNewLine + \"DCF\" + item.documentDiscriminator; //documentDiscriminator","  pdf417 += uNewLine + \"DCG\" + item.residentCountry.toUpperCase(); //countryIdentification","  pdf417 += uNewLine + \"DAW\" + item.weight.toUpperCase(); //weightPounds","  pdf417 += uNewLine + \"DAZ\" + item.hairColor.toUpperCase(); //hairColor","  pdf417 += uNewLine + \"DCK\" + item.administrativeNumber.toUpperCase(); //inventoryControlNumber","  pdf417 += uNewLine + \"DDA\" + item.complianceType.toUpperCase(); //complianceType","  pdf417 += uNewLine + \"DDB\" + \"08292017\"; //cardRevisionDate ","  pdf417 += \"\\u0013\";","  return pdf417;","","}","const getAamVaData = async (item) => {","  let pdf417 = \"@\\n\\u001e\\rANSI 636055090102DL00410252ZG02930127DL\";","  let uNewLine =\"\\n\";","","  let aGivenName = item.givenName.split(\" \");","  let firstName = aGivenName[0];","  let middleName = aGivenName[1];","","  ","  ","  pdf417 += \"DAQ\" + item.documentNumber;","  pdf417 += uNewLine + \"DCS\" + item.familyName.toUpperCase(); //lastName","  pdf417 += uNewLine + \"DDE\" + \"N\"; //isLastNameTruncated","  pdf417 += uNewLine + \"DAC\" + firstName.toUpperCase(); //firstName","  pdf417 += uNewLine + \"DDF\" + \"N\"; //isFirstNameTruncated","  pdf417 += uNewLine + \"DAD\" + (middleName == undefined) ? '' : middleName.toUpperCase();","  pdf417 += uNewLine + \"DDG\" + \"N\"; //isMiddleNameTruncated","  pdf417 += uNewLine + \"DCA\" + item.vehicleClass.toUpperCase(); //jurisdictionSpecificVehicleClass","  pdf417 += uNewLine + \"DCB\" + ((item.domesticDrivingPrivileges[0].domesticVehicleRestrictions[0].domesticVehicleRestrictionCode == undefined) ? \"NONE\" : item.domesticDrivingPrivileges[0].domesticVehicleRestrictions[0].domesticVehicleRestrictionCode); //jurisdictionSpecificRestrictionCodes","  pdf417 += uNewLine + \"DCD\" + ((item.domesticDrivingPrivileges[0].domesticVehicleEndorsements[0].domesticVehicleEndorsementCode == undefined) ? \"NONE\" : item.domesticDrivingPrivileges[0].domesticVehicleEndorsements[0].domesticVehicleEndorsementCode); //jurisdictionSpecificEndorsementCodes","  pdf417 += uNewLine + \"DBD\" + await getpdf417DateFormat(item.issue); //documentIssueDate","  pdf417 += uNewLine + \"DBB\" + await getpdf417DateFormat(item.birthDate); //dateOfBirth","  pdf417 += uNewLine + \"DBA\" + await getpdf417DateFormat(item.expiry); //documentExpirationDate","  pdf417 += uNewLine + \"DBC\" + item.sex.toUpperCase(); //physicalDescriptionSex","  pdf417 += uNewLine + \"DAU\" + item.height.toUpperCase(); //physicalDescriptionHeight","  pdf417 += uNewLine + \"DAY\" + item.eyeColor.toUpperCase(); //physicalDescriptionEyeColor","  pdf417 += uNewLine + \"DAG\" + item.residentAddress.toUpperCase(); //addressStreet1","  pdf417 += uNewLine + \"DAI\" + item.residentCity.toUpperCase(); //addressCity","  pdf417 += uNewLine + \"DAJ\" + item.residentState.toUpperCase(); //addressJurisdictionCode","  pdf417 += uNewLine + \"DAK\" + item.residentPostalCode.toUpperCase(); //addressPostalCode","  pdf417 += uNewLine + \"DCF\" + item.documentDiscriminator; //documentDiscriminator","  pdf417 += uNewLine + \"DCG\" + item.residentCountry.toUpperCase(); //countryIdentification","  pdf417 += uNewLine + \"DAW\" + item.weight.toUpperCase(); //weightPounds","  pdf417 += uNewLine + \"DAZ\" + item.hairColor.toUpperCase(); //hairColor","  pdf417 += uNewLine + \"DCK\" + item.administrativeNumber.toUpperCase(); //inventoryControlNumber","  pdf417 += uNewLine + \"DDA\" + item.complianceType.toUpperCase(); //complianceType","  pdf417 += uNewLine + \"DDB\" + \"08292017\"; //cardRevisionDate ","  pdf417 += \"\\rZCZCAHZL\\nZCBBRN\\nZCC\\nZCD\\r\";","  return pdf417;","","}","const getpdf417DateFormat = async (inDateString) => {","  let inDate = new Date(inDateString);","  let mm = inDate.getMonth() + 1; // getMonth() is zero-based","  let dd = inDate.getDate();","","  return [","          (mm>9 ? '' : '0') + mm,","          (dd>9 ? '' : '0') + dd,","          inDate.getFullYear(), ","        ].join('');","  ","}"],"id":54}],[{"start":{"row":61,"column":15},"end":{"row":61,"column":29},"action":"remove","lines":["documentNumber"],"id":55},{"start":{"row":61,"column":15},"end":{"row":61,"column":16},"action":"insert","lines":["i"]},{"start":{"row":61,"column":16},"end":{"row":61,"column":17},"action":"insert","lines":["t"]},{"start":{"row":61,"column":17},"end":{"row":61,"column":18},"action":"insert","lines":["e"]},{"start":{"row":61,"column":18},"end":{"row":61,"column":19},"action":"insert","lines":["m"]},{"start":{"row":61,"column":19},"end":{"row":61,"column":20},"action":"insert","lines":["N"]},{"start":{"row":61,"column":20},"end":{"row":61,"column":21},"action":"insert","lines":["a"]},{"start":{"row":61,"column":21},"end":{"row":61,"column":22},"action":"insert","lines":["m"]},{"start":{"row":61,"column":22},"end":{"row":61,"column":23},"action":"insert","lines":["e"]}],[{"start":{"row":61,"column":29},"end":{"row":61,"column":43},"action":"remove","lines":["documentNumber"],"id":56},{"start":{"row":61,"column":29},"end":{"row":61,"column":30},"action":"insert","lines":["i"]},{"start":{"row":61,"column":30},"end":{"row":61,"column":31},"action":"insert","lines":["t"]},{"start":{"row":61,"column":31},"end":{"row":61,"column":32},"action":"insert","lines":["e"]},{"start":{"row":61,"column":32},"end":{"row":61,"column":33},"action":"insert","lines":["m"]},{"start":{"row":61,"column":33},"end":{"row":61,"column":34},"action":"insert","lines":["N"]},{"start":{"row":61,"column":34},"end":{"row":61,"column":35},"action":"insert","lines":["a"]},{"start":{"row":61,"column":35},"end":{"row":61,"column":36},"action":"insert","lines":["m"]},{"start":{"row":61,"column":36},"end":{"row":61,"column":37},"action":"insert","lines":["e"]}],[{"start":{"row":4,"column":75},"end":{"row":5,"column":39},"action":"remove","lines":["","import {format} from './itemFormat.mjs'"],"id":57}],[{"start":{"row":15,"column":16},"end":{"row":15,"column":20},"action":"remove","lines":["ById"],"id":58},{"start":{"row":15,"column":16},"end":{"row":15,"column":17},"action":"insert","lines":["I"]},{"start":{"row":15,"column":17},"end":{"row":15,"column":18},"action":"insert","lines":["t"]},{"start":{"row":15,"column":18},"end":{"row":15,"column":19},"action":"insert","lines":["e"]},{"start":{"row":15,"column":19},"end":{"row":15,"column":20},"action":"insert","lines":["m"]}],[{"start":{"row":60,"column":0},"end":{"row":60,"column":3},"action":"insert","lines":["// "],"id":59}],[{"start":{"row":58,"column":0},"end":{"row":58,"column":3},"action":"insert","lines":["// "],"id":60}],[{"start":{"row":60,"column":0},"end":{"row":60,"column":3},"action":"remove","lines":["// "],"id":61}],[{"start":{"row":10,"column":44},"end":{"row":11,"column":0},"action":"insert","lines":["",""],"id":62},{"start":{"row":11,"column":0},"end":{"row":11,"column":1},"action":"insert","lines":["c"]},{"start":{"row":11,"column":1},"end":{"row":11,"column":2},"action":"insert","lines":["o"]},{"start":{"row":11,"column":2},"end":{"row":11,"column":3},"action":"insert","lines":["n"]},{"start":{"row":11,"column":3},"end":{"row":11,"column":4},"action":"insert","lines":["s"]},{"start":{"row":11,"column":4},"end":{"row":11,"column":5},"action":"insert","lines":["o"]},{"start":{"row":11,"column":5},"end":{"row":11,"column":6},"action":"insert","lines":["l"]},{"start":{"row":11,"column":6},"end":{"row":11,"column":7},"action":"insert","lines":["e"]},{"start":{"row":11,"column":7},"end":{"row":11,"column":8},"action":"insert","lines":["."]},{"start":{"row":11,"column":8},"end":{"row":11,"column":9},"action":"insert","lines":["l"]},{"start":{"row":11,"column":9},"end":{"row":11,"column":10},"action":"insert","lines":["o"]},{"start":{"row":11,"column":10},"end":{"row":11,"column":11},"action":"insert","lines":["g"]}],[{"start":{"row":11,"column":11},"end":{"row":11,"column":13},"action":"insert","lines":["()"],"id":63}],[{"start":{"row":11,"column":12},"end":{"row":11,"column":13},"action":"insert","lines":["t"],"id":64},{"start":{"row":11,"column":13},"end":{"row":11,"column":14},"action":"insert","lines":["a"]},{"start":{"row":11,"column":14},"end":{"row":11,"column":15},"action":"insert","lines":["b"]},{"start":{"row":11,"column":15},"end":{"row":11,"column":16},"action":"insert","lines":["l"]},{"start":{"row":11,"column":16},"end":{"row":11,"column":17},"action":"insert","lines":["e"]},{"start":{"row":11,"column":17},"end":{"row":11,"column":18},"action":"insert","lines":["N"]},{"start":{"row":11,"column":18},"end":{"row":11,"column":19},"action":"insert","lines":["a"]},{"start":{"row":11,"column":19},"end":{"row":11,"column":20},"action":"insert","lines":["m"]},{"start":{"row":11,"column":20},"end":{"row":11,"column":21},"action":"insert","lines":["e"]}],[{"start":{"row":11,"column":22},"end":{"row":11,"column":23},"action":"insert","lines":[";"],"id":65}],[{"start":{"row":11,"column":12},"end":{"row":11,"column":13},"action":"insert","lines":["\""],"id":66},{"start":{"row":11,"column":13},"end":{"row":11,"column":14},"action":"insert","lines":["t"]},{"start":{"row":11,"column":14},"end":{"row":11,"column":15},"action":"insert","lines":["a"]},{"start":{"row":11,"column":15},"end":{"row":11,"column":16},"action":"insert","lines":["b"]},{"start":{"row":11,"column":16},"end":{"row":11,"column":17},"action":"insert","lines":["l"]},{"start":{"row":11,"column":17},"end":{"row":11,"column":18},"action":"insert","lines":["e"]},{"start":{"row":11,"column":18},"end":{"row":11,"column":19},"action":"insert","lines":["N"]},{"start":{"row":11,"column":19},"end":{"row":11,"column":20},"action":"insert","lines":["a"]},{"start":{"row":11,"column":20},"end":{"row":11,"column":21},"action":"insert","lines":["m"]},{"start":{"row":11,"column":21},"end":{"row":11,"column":22},"action":"insert","lines":["e"]}],[{"start":{"row":11,"column":22},"end":{"row":11,"column":23},"action":"insert","lines":["="],"id":67},{"start":{"row":11,"column":23},"end":{"row":11,"column":24},"action":"insert","lines":["\""]}],[{"start":{"row":11,"column":24},"end":{"row":11,"column":25},"action":"insert","lines":[" "],"id":68},{"start":{"row":11,"column":25},"end":{"row":11,"column":26},"action":"insert","lines":["+"]}],[{"start":{"row":11,"column":26},"end":{"row":11,"column":27},"action":"insert","lines":[" "],"id":69}],[{"start":{"row":10,"column":18},"end":{"row":10,"column":43},"action":"remove","lines":["process.env.CITIZEN_TABLE"],"id":70},{"start":{"row":10,"column":18},"end":{"row":10,"column":19},"action":"insert","lines":["i"]},{"start":{"row":10,"column":19},"end":{"row":10,"column":20},"action":"insert","lines":["t"]},{"start":{"row":10,"column":20},"end":{"row":10,"column":21},"action":"insert","lines":["e"]},{"start":{"row":10,"column":21},"end":{"row":10,"column":22},"action":"insert","lines":["m"]}],[{"start":{"row":10,"column":18},"end":{"row":10,"column":22},"action":"remove","lines":["item"],"id":71},{"start":{"row":10,"column":18},"end":{"row":10,"column":19},"action":"insert","lines":["p"]},{"start":{"row":10,"column":19},"end":{"row":10,"column":20},"action":"insert","lines":["r"]},{"start":{"row":10,"column":20},"end":{"row":10,"column":21},"action":"insert","lines":["o"]},{"start":{"row":10,"column":21},"end":{"row":10,"column":22},"action":"insert","lines":["d"]},{"start":{"row":10,"column":22},"end":{"row":10,"column":23},"action":"insert","lines":["u"]},{"start":{"row":10,"column":23},"end":{"row":10,"column":24},"action":"insert","lines":["c"]},{"start":{"row":10,"column":24},"end":{"row":10,"column":25},"action":"insert","lines":["t"]},{"start":{"row":10,"column":25},"end":{"row":10,"column":26},"action":"insert","lines":["T"]},{"start":{"row":10,"column":26},"end":{"row":10,"column":27},"action":"insert","lines":["a"]},{"start":{"row":10,"column":27},"end":{"row":10,"column":28},"action":"insert","lines":["b"]},{"start":{"row":10,"column":28},"end":{"row":10,"column":29},"action":"insert","lines":["l"]},{"start":{"row":10,"column":29},"end":{"row":10,"column":30},"action":"insert","lines":["e"]}],[{"start":{"row":10,"column":0},"end":{"row":10,"column":31},"action":"remove","lines":["const tableName = productTable;"],"id":72},{"start":{"row":10,"column":0},"end":{"row":10,"column":33},"action":"insert","lines":["const tableName = 'productTable';"]}],[{"start":{"row":10,"column":33},"end":{"row":11,"column":38},"action":"remove","lines":["","console.log(\"tableName=\" + tableName);"],"id":73}],[{"start":{"row":54,"column":25},"end":{"row":54,"column":29},"action":"remove","lines":["item"],"id":74},{"start":{"row":54,"column":25},"end":{"row":54,"column":26},"action":"insert","lines":["d"]},{"start":{"row":54,"column":26},"end":{"row":54,"column":27},"action":"insert","lines":["a"]},{"start":{"row":54,"column":27},"end":{"row":54,"column":28},"action":"insert","lines":["t"]},{"start":{"row":54,"column":28},"end":{"row":54,"column":29},"action":"insert","lines":["a"]}],[{"start":{"row":46,"column":4},"end":{"row":46,"column":7},"action":"insert","lines":["// "],"id":75}],[{"start":{"row":45,"column":65},"end":{"row":46,"column":42},"action":"remove","lines":["","    // var item = await format(data.Item);"],"id":76}],[{"start":{"row":45,"column":65},"end":{"row":46,"column":0},"action":"insert","lines":["",""],"id":77},{"start":{"row":46,"column":0},"end":{"row":46,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":46,"column":4},"end":{"row":46,"column":25},"action":"insert","lines":["var item = data.Item;"],"id":78}],[{"start":{"row":46,"column":25},"end":{"row":47,"column":0},"action":"remove","lines":["",""],"id":79}],[{"start":{"row":46,"column":25},"end":{"row":47,"column":0},"action":"insert","lines":["",""],"id":80},{"start":{"row":47,"column":0},"end":{"row":47,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":54,"column":25},"end":{"row":54,"column":29},"action":"remove","lines":["data"],"id":81},{"start":{"row":54,"column":25},"end":{"row":54,"column":26},"action":"insert","lines":["i"]},{"start":{"row":54,"column":26},"end":{"row":54,"column":27},"action":"insert","lines":["t"]},{"start":{"row":54,"column":27},"end":{"row":54,"column":28},"action":"insert","lines":["e"]},{"start":{"row":54,"column":28},"end":{"row":54,"column":29},"action":"insert","lines":["m"]}]]},"ace":{"folds":[],"scrolltop":22.80000000000027,"scrollleft":0,"selection":{"start":{"row":50,"column":3},"end":{"row":50,"column":3},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1713578878751,"hash":"185d1b9d4d067371b9a73a6dd9dba976a1362ca3"}